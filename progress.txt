## 2026-01-23: Step 1 Complete - subtask-markdown.ts

Created `src/core/subtask-markdown.ts` with parsing/rendering helpers for embedding subtasks in GitHub Issue bodies.

### Functions implemented:
- `parseSubtaskId(id)` - Parse compound ID (e.g., "9-1") to { parentId, localIndex }
- `createSubtaskId(parentId, index)` - Create compound ID string
- `parseIssueBody(body)` - Extract parent context and embedded subtasks from issue body
- `renderIssueBody(context, subtasks)` - Render issue body with embedded subtasks as <details> blocks
- `taskToEmbeddedSubtask(task)` - Convert Task to EmbeddedSubtask format
- `embeddedSubtaskToTask(subtask, parentId)` - Convert EmbeddedSubtask to Task with parent_id
- `getNextSubtaskIndex(existingSubtasks)` - Get next available local index

### Tests:
- Created `src/core/subtask-markdown.test.ts` with 17 unit tests
- All tests pass
- Full test suite (207 tests) passes
- TypeScript build passes

### Next step:
Step 2 - Modify `src/core/github-issues-storage.ts` to use the new subtask-markdown helpers

## 2026-01-23: Step 2 Complete - github-issues-storage.ts

Modified `src/core/github-issues-storage.ts` to use the subtask-markdown helpers for embedding subtasks in parent issue bodies.

### Changes made:
- **Imports**: Added imports from `subtask-markdown.ts`
- **`issueToTask()`**: Now uses `parseIssueBody()` to extract only parent context (excludes `## Subtasks` section)
- **`readAsync()`**: After converting issue to parent task, parses embedded subtasks and adds them to tasks array with `parent_id` set
- **`writeAsync()`**: Partitions tasks into parents and subtasks, groups subtasks by parent, warns about orphans
- **`createIssueWithSubtasks()`**: New method - creates GitHub Issue, assigns compound IDs to subtasks, renders body with embedded subtasks
- **`updateIssueWithSubtasks()`**: New method - fetches current issue, merges subtasks, updates body

### Verification:
- TypeScript build passes (`npm run build`)
- Full test suite passes (207 tests)

### Next step:
Step 3 - Add integration tests (mock Octokit) for the new github-issues-storage.ts functionality

## 2026-01-23: Step 3 Complete - Integration Tests

Created `src/core/github-issues-storage.test.ts` with 17 integration tests using mocked Octokit.

### Tests added:
- **readAsync()**:
  - Reads parent task without subtasks
  - Reads parent task with embedded subtasks (verifies subtask parsing)
  - Skips pull requests
  - Reads closed issues as completed tasks
  - Throws StorageError on API failure

- **writeAsync()**:
  - Creates new parent task without subtasks
  - Creates parent task with subtasks embedded
  - Updates existing issue with subtasks
  - Creates completed parent task with closed state
  - Warns about orphaned subtasks
  - Throws StorageError on API failure
  - Handles subtask status update (checkbox change)
  - Removes subtask when not included in write

- **Utility methods**:
  - read() throws error (sync not supported)
  - write() throws error (sync not supported)
  - isSync() returns false
  - getIdentifier() returns owner/repo

### Verification:
- TypeScript build passes (`npm run build`)
- Full test suite passes (241 tests)

### Implementation Complete
All three steps from the PRD are now complete:
1. ✅ subtask-markdown.ts - Parsing/rendering helpers
2. ✅ github-issues-storage.ts - Integration with subtask embedding
3. ✅ Integration tests - Mock Octokit tests for full coverage
